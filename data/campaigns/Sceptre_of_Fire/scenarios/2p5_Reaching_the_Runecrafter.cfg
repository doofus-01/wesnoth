#textdomain wesnoth-sof
[scenario]
    name= _ "Reaching the Runecrafter"
    id=2p5_Reaching_the_Runecrafter
    turns=15
    map_file=campaigns/Sceptre_of_Fire/maps/2p5_Reaching_the_Runecrafter.map
    next_scenario=3_Searching_for_the_Runecrafter
    victory_when_enemies_defeated=yes

    {SCENARIO_MUSIC battle.ogg}
    {EXTRA_SCENARIO_MUSIC the_city_falls.ogg}

    {DEFAULT_SCHEDULE}

    [side]
        type=Dwarvish Fighter
        id=Rugnur
        side=1
        canrecruit=yes
        shroud=no
        controller=human
        recruit=Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Guardsman,Dwarvish Scout
        team_name=dwarves
        user_team_name= _ "Dwarves"
        {FLAG_VARIANT knalgan}
    [/side]

    [side]
        type=Orcish Warrior
        id=Bragdash
        name= _ "Bragdash Gar"
        side=2
        canrecruit=yes
        {RECRUIT (Orcish Grunt) (Orcish Grunt, Orcish Archer) (Orcish Grunt, Orcish Archer, Orcish Assassin)}
        {GOLD 200 250 300}
        {INCOME 8 12 16}
        team_name=orcs
        user_team_name= _ "Orcs"
        {FLAG_VARIANT ragged}
#        [ai]
#            aggression=1.0
#            caution=0.0
#        [/ai]
    [/side]

    [side]
        type=Goblin Rouser
        id=Pidmer
        name= _ "Pidmer Gar"
        side=3
        canrecruit=yes
        recruit=Goblin Spearman
        {GOLD 100 140 180}
        {INCOME 8 12 16}
        team_name=orcs
        user_team_name= _ "Goblins"
        {FLAG_VARIANT ragged}
#        [ai]
#            aggression=1.0
#            caution=0.0
#        [/ai]
    [/side]

    [story]
        [part]
            story= _ "The journey to the far northern wastelands was long and perilous. The tunnels were narrow, but by following the old mining rails, Rugnur and his group could make good time.  After a few days journey, they saw a dim red glow in the tunnel ahead, and could feel sporatic vibrations in the rails."
        [/part]
        [part]
            story= _ "As the group got near the source of the glow, they heard metallic banging and guttural shouting, and their noses were assaulted by a fetid smell..."
        [/part]
    [/story]

#    {SOF_TRACK {JOURNEY_02_NEW} }

    {SOF_DEATHS}

    [event]
        name=prestart

        [objectives]
            side=1
            [objective]
                description= _ "Defeat Enemy Leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Rugnur"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Baglur"
                condition=lose
            [/objective]

            {TURNS_RUN_OUT}

            [gold_carryover]
                bonus=yes
                carryover_percentage=40
            [/gold_carryover]
        [/objectives]

        {GENERIC_UNIT 3 "Goblin Impaler" 9 15} {GUARDIAN}
        {GENERIC_UNIT 2 "Orcish Warrior" 18 15} {GUARDIAN}

        {SOF_MINECART_MENU cart1 10 25}
        {SOF_MINECART_MENU cart2 13 9}
    [/event]

    [event]
        name=start
        {MOVE_UNIT id=Rugnur 13 27}
        [recall]
            id=Alanin
        [/recall]
        [recall]
            id=Baglur
        [/recall]
        [redraw]
            side=1
        [/redraw]
        # need to check if this makes sense, has Rugnur seen an orc before?
        [message]
            speaker=Rugnur
            message= _ "Those are orcs, aren't they?"
        [/message]
        [message]
            speaker=Baglur
            message= _ "Aye, in all their destructive glory.  Looks like they're trying to strip the metal from the rails."
        [/message]
        [message]
            speaker=Alanin
            message= _ "That's terrible, someone should stop them!"
        [/message]
        [message]
            speaker=Rugnur
            message= _ "Do orcs always stink so bad?  I've heard that they are stupid and messy, but this is almost unbearable!"
        [/message]
        [message]
            speaker=Bragdash
            message= _ "We see you, we hear you, sneaky little moles!  Pidmer, go skewer them!"
        [/message]
        [message]
            speaker=Pidmer
            message= _ "Um... Aren't we needed for the salvage?"
        [/message]
        [message]
            speaker=Bragdash
            message= _ "No!  You've been straining and struggling, but the tracks are untouched!  It takes a strong orc to break that steel, you go deal with those little cave rats.  You can keep their shiny helmets, they might fit you."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=1-5,9-13
        [/filter]
        [message]
            speaker=unit
            message= _ "(*gasp*) I think I've found the source of the terrible smell, it wasn't the orcs..."
        [/message]
        [message]
            speaker=Bragdash
            message= _ "Of course it wasn't us, you worm!"
        [/message]
        [message]
            speaker=unit
            message= _ "This underground river is choked off with a rotting mess, it's overgrown with fungus.  I can try to see what's underneath...  Whoops!"
        [/message]
        [replace_map]
            map_file=campaigns/Sceptre_of_Fire/maps/2p5_Reaching_the_Runecrafter2.map
        [/replace_map]
        [redraw]
            side=1
        [/redraw]
        # assuming he is near his keep
        [message]
            speaker=Pidmer
            message= _ "Ah!"
        [/message]
        [kill]
            id=Pidmer
        [/kill]
        [replace_map]
            map_file=campaigns/Sceptre_of_Fire/maps/2p5_Reaching_the_Runecrafter3.map
        [/replace_map]
        [redraw]
            side=1
        [/redraw]
        [message]
            speaker=Bragdash
            message= _ "You've flooded your own tunnel, you stupid little gophers!"
        [/message]
        [message]
            speaker=Baglur
            message= _ "Och, we 'ave...  But our rails are as strong and stout as we are!"
        [/message]
        [message]
            speaker=Rugnur
            message= _ "We can continue along the rails!"
        [/message]
        [message]
            speaker=Alanin
            message= _ "That's good, because I can't swim."
        [/message]
        [kill]
            [and]
                side=2
                [filter_location]
                    terrain=Wo*
                [/filter_location]
            [/and]
            animate=no
            fire_event=yes
        [/kill]
    [/event]
        
    [event]
        name=die
        [filter]
            id=Baglur
        [/filter]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

[/scenario]

